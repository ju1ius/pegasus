{% set result_var = result_varname(expr) %}
{% set pos_var = position_varname(expr) %}
{{ expr_comment(expr) }}
{{ result_var }} = null;
do {
    {{ pos_var }} = $this->pos;
{% for child in expr -%}
    {% set subres_var = result_varname(child) %}
    {{ render_expr(child)|indent }}
    if ({{ subres_var }}) {
        {{ result_var }} = {{ subres_var }};
        break;
    }
    $this->pos = {{ pos_var }};
{% endfor %}
} while (0);
if ({{ result_var }}) {
    {{ result_var }} = $this->isCapturing
        ? new Node\Decorator('{{ expr.name }}', {{ pos_var }}, $this->pos, {{ result_var }})
        : true;
} else {
    {{ macros.error(expr, pos_var)|indent }}
}
